import { Meta } from '@storybook/blocks';

<Meta title="Exemples" />

# Exemples

## bootstrap-v5

Remplacez l'import du style par défaut de Bootstrap au sein de votre applicatif.

Si vous utilisez le préprocesseur SASS vous pouvez importer le style :

```
dsfr-connect/src/bootstrap-v5/index.scss
```

Sinon pour du CSS "statique" :

```
dsfr-connect/dist/bootstrap-v5/index.css
```

## vuetify-v3

Personnaliser Vuetify se fait en 2 temps :

1. on utilise un thème JavaScript pour définir les couleurs principales
2. on utilise un thème SASS/CSS pour modifier la composition de l'application et des composants

Tout d'abord, adaptez votre initialisation du plugin Vuetify :

```ts
import '@mdi/font/css/materialdesignicons.css';
import { getVuetifyOptions } from 'dsfr-connect/src/vuetify-v3';
import { createVuetify } from 'vuetify';
import * as components from 'vuetify/components';
import * as directives from 'vuetify/directives';
import * as labsComponents from 'vuetify/labs/components';
import 'vuetify/styles';

export default createVuetify({
  components: { components, labsComponents },
  directives,
  ...getVuetifyOptions(),
});
```

Si besoin, se référer à la documentation officielle : [https://v3.vuetifyjs.com/en/getting-started/installation/]()

Ensuite la partie plus compliqué est que le style des composants est géré différemment de celui de l'application. Il faut modifier le préprocesseur que vous utilisez (Vite/Webpack) afin de lui dire d'utiliser une feuille de style spécifique pour compiler les composants Vuetify. Au final cela donnerait :

```ts
// Vite/Nuxt
vuetify({
  styles: { configFile: 'dsfr-connect/src/vuetify-v3/settings.scss' },
});

// Webpack/Vue CLI
new VuetifyPlugin({
  styles: { configFile: 'dsfr-connect/src/vuetify-v3/settings.scss' },
});
```

Les démarches pour importer ces helpers sont détaillées sur [https://vuetifyjs.com/en/features/sass-variables/#component-specific-variables]().

## mui-v5

_Le thème MUI avait déjà été implémenté dans la librairie [https://github.com/codegouvfr/react-dsfr](), nous ne faisons que le réutiliser et le référencer. La plus-value de l'avoir intégré au sein de `dsfr-connect` est qu'il sera beaucoup plus facile via le Storybook de consulter une large panoplie d'états de MUI afin de perfectionner le thème initial._

Les indications pour installer le thème peuvent directement être lues sur [https://react-dsfr.etalab.studio]() et plus particulièrement [https://react-dsfr.etalab.studio/mui]() (à noter que l'initialisation globale de `react-dsfr` est nécessaire pour que leur thème MUI fonctionne, ne sautez donc pas d'étapes).

Nous vous proposons ci-dessous quelques "améliorations" au moment où vous suivrez leurs instructions (ce afin de bénéficier pleinement de certains "plugins") :

```ts
// dsfr-connect/src/mui-v5/index.ts
import { createMuiDsfrThemeProvider } from '@codegouvfr/react-dsfr/mui';
import { frFR as coreFrFR } from '@mui/material/locale';
import { frFR as dataGridFrFR } from '@mui/x-data-grid/locales/frFR';
import { frFR as datePickerFrFR } from '@mui/x-date-pickers/locales/frFR';

export const { MuiDsfrThemeProvider } = createMuiDsfrThemeProvider({
  augmentMuiTheme: ({ nonAugmentedMuiTheme, frColorTheme }) => {
    return {
      ...nonAugmentedMuiTheme,
      components: {
        ...nonAugmentedMuiTheme.components,
        // Bring i18n for components like DatePicker
        ...datePickerFrFR.components,
        ...dataGridFrFR.components,
        ...coreFrFR.components,
        MuiDialogContent: {
          // TODO: remove once the issue is addressed: https://github.com/mui/material-ui/issues/31185
          styleOverrides: { root: { paddingTop: `1rem !important` } },
        },
      },
    };
  },
});
```

## storybook-v7

**À noter qu'il faut différencier la partie "dashboard" Storybook et le contenu des stories.**

### Modifier l'apparence de l'outil

#### Spéficier un thème

Dans votre configuration Storybook mettre :

```ts
// .storybook/manager.ts
import { darkTheme, lightTheme } from 'dsfr-connect/dist/storybook-v7';

export const config: Addon_Config = {
  theme: darkTheme,
};
```

#### Modifications additionnelles

Les thèmes Storybook ne permettent pas une grande amplitude dans les modifications, et il est nécessaire d'utiliser un peu de style CSS en plus. Malheureusement il n'y a pas la possibilité d'importer directement du style dans le `main.ts`, nous sommes obligés de passer par du HTML pour définir nos styles.

Pour ces raisons, ci-dessous nous utilisons un helper afin d'utiliser un `.css` précompilé pour l'apparence mais aussi pour aller chercher les fonts DSFR.

```ts
// .storybook/main.ts
import { darkTheme, lightTheme } from 'dsfr-connect/dist/storybook-v7';

export default <StorybookConfig>{
  ...
  managerHead: managerHeadFactory(),
};
```

#### Utiliser le dark mode

Il n'y a pas de gestion native pour gérer 2 thèmes (bien que la UI Storybook de base sache le faire, ce n'est pas paramétable). Il faut vous pour cela utiliser le plugin [https://github.com/hipstersmoothie/storybook-dark-mode]().

Vous devrez faire en sorte de ne pas spécifier de thème dans `manager.ts` puis mettre dans votre configuration Storybook :

```ts
// .storybook/preview.ts
import { darkTheme, lightTheme } from 'dsfr-connect/dist/storybook-v7';

export const preview = {
  parameters: {
    darkMode: {
      light: lightTheme,
      dark: darkTheme,
    },
  },
};
```

#### Surcharger le thème

Il est possible que vous souhaitiez personnaliser le titre, le logo... rien de plus simple ! Vous pouvez surcharger les thèmes de cette façon :

```ts
import { lightTheme } from 'dsfr-connect/dist/storybook-v7';

export const lightTheme = {
  ...lightTheme,
  brandTitle: 'Mon propre nom',
  brandUrl: 'https://example.com',
  brandImage: '/assets/logo.png', // Placez votre image dans `public/assets/logo.png` et utilisez dans votre configuration du `main.ts` : `staticDirs: ['../public'],`
};
```

_N'hésitez pas à aller voir l'interface `ThemeVars` dans `dsfr-connect/src/storybook-v7` afin de comprendre ce qui est personnalisable._

### Utiliser le DSFR dans les stories

```ts
// .storybook/preview.ts
import '@gouvfr/dsfr/dist/dsfr/dsfr.css';
import '@gouvfr/dsfr/dist/utility/utility.css';
import 'dsfr-connect/dist/fonts/index.css';
```

Cet exemple est pour le DSFR "brut", c'est à dire qu'on ne décrit pas les initialisations propres à l'implémentation DSFR que vous pourriez utiliser (`react-dsfr`, `vue-dsfr`...). Aussi, il ne prend pas en compte la gestion du dark mode car celui-ci doit être géré par des plugins Storybook tiers (libre à vous de vous inspirer du code de ce Storybook).

### Utiliser le DSFR dans les fichiers de documentation

Si écrivez `.mdx` dans Storybook v7 vous avez probablement remarqué que le style par défaut de Storybook est en conflit avec celui du DSFR. La solution que nous avons trouvé est de les mettre dans un composant `<Unstyled>`. Bien que cela ne règle pas des conflits sur certains liens en markdown, cela vous aidera grandement.

```ts
// .storybook/preview.ts
import { DocsContainer } from 'dsfr-connect/dist/storybook-v7';

export default {
  ...
  parameters: {
    docs: {
      container: DocsContainer,
    },
  },
};
```
